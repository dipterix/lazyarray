<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A Basic Usage of 'LazyArray' • lazyarray</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="A Basic Usage of 'LazyArray'">
<meta property="og:description" content="lazyarray">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lazyarray</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/basic-usage-of-lazyarray.html">A Basic Usage of 'LazyArray'</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dipterix/lazyarray/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="basic-usage-of-lazyarray_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="basic-usage-of-lazyarray_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="basic-usage-of-lazyarray_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>A Basic Usage of ‘LazyArray’</h1>
                        <h4 class="author">Zhengjia Wang</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dipterix/lazyarray/blob/master/vignettes/basic-usage-of-lazyarray.Rmd"><code>vignettes/basic-usage-of-lazyarray.Rmd</code></a></small>
      <div class="hidden name"><code>basic-usage-of-lazyarray.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dipterix/lazyarray">lazyarray</a></span><span class="op">)</span></code></pre></div>
<div id="initialize" class="section level3">
<h3 class="hasAnchor">
<a href="#initialize" class="anchor"></a>Initialize</h3>
<p>Create a blank array and assign R object</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Sample data (~24 MB)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">3e6</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">30</span><span class="op">)</span>

<span class="co"># Save array to a path</span>
<span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">arr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lazyarray.html">lazyarray</a></span><span class="op">(</span><span class="va">path</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, storage_format <span class="op">=</span> <span class="st">'double'</span><span class="op">)</span>
<span class="va">arr</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">x</span></code></pre></div>
<p>Load existing array</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load existing array</span>
<span class="va">arr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lazyarray.html">lazyarray</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span></code></pre></div>
<p>To protect array from further changes, make it read-only.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">arr</span><span class="op">$</span><span class="fu">make_readonly</span><span class="op">(</span><span class="op">)</span>
<span class="va">arr</span><span class="op">$</span><span class="va">can_write</span>
<span class="co">#&gt; [1] FALSE</span></code></pre></div>
<p>To make a read-only array writable:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">arr</span><span class="op">$</span><span class="fu">make_writable</span><span class="op">(</span><span class="op">)</span>
<span class="va">arr</span><span class="op">$</span><span class="va">can_write</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
</div>
<div id="s3-methods" class="section level3">
<h3 class="hasAnchor">
<a href="#s3-methods" class="anchor"></a>S3 methods</h3>
<ol style="list-style-type: decimal">
<li>Set dimension names</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">arr</span><span class="op">$</span><span class="fu">make_writable</span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span><span class="op">(</span><span class="va">arr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  A <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,
  B <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,
  C <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,
  D <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">30</span>
<span class="op">)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Subset and subset assign</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Subset/read array</span>
<span class="va">y1</span> <span class="op">&lt;-</span> <span class="va">arr</span><span class="op">[</span><span class="op">]</span>              
<span class="va">y2</span> <span class="op">&lt;-</span> <span class="va">arr</span><span class="op">[</span>,,,<span class="fl">3</span><span class="op">]</span>          

<span class="co"># Write to slice of data, writing to slices along the </span>
<span class="co"># last dimension is optimized</span>
<span class="va">arr</span><span class="op">[</span>,,,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="fl">1e5</span><span class="op">)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Subset by formula</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">arr</span>, <span class="va">A</span> <span class="op">~</span> <span class="va">A</span> <span class="op">&lt;=</span> <span class="fl">2</span>, <span class="va">B</span> <span class="op">~</span> <span class="va">B</span> <span class="op">==</span> <span class="fl">10</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">sub</span><span class="op">)</span>
<span class="co">#&gt; [1]   2   1 100  30</span></code></pre></div>
</div>
<div id="remove-arrays" class="section level3">
<h3 class="hasAnchor">
<a href="#remove-arrays" class="anchor"></a>Remove Arrays</h3>
<p>Data created via <code>lazyarray</code> does not remove automatically. You need to finalize array by yourself. This is because multiple lazy array instances might point to a same dataset. If one of the object is garbage collected, you might not want to remove the data on hard drive as this will invalidate the other instances. To manually remove data, use</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">arr</span><span class="op">$</span><span class="fu">remove_data</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Zhengjia Wang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
